[廖雪峰 git 教程](https://www.liaoxuefeng.com/wiki/896043488029600/896202780297248#0)

[TOC]

### Intro

git 是目前世界上最先进的分布式版本控制系统。

集中式和分布式：

集中式版本控制系统，版本库是集中存放在中央服务器。需要从中央服务器取得最新的版本库，然后开始修改，修改完后再推送给中央服务器。必须联网才能工作，网速慢的话，提交会很耗时。（这里的提交指的应该是对应到 git 里的那个 commit 过程）

分布式版本控制系统，没有中央服务器，每个人的电脑上都是一个完整的版本库，在工作的时候就不需要联网了。多个人协作的话，只需要把各自的修改推送给对方，就可以互相看到对方的修改了。

分布式版本控制系统安全性要高很多，因为每个人的电脑里都有一个完整的版本库。集中式版本控制系统的中央服务器要是出了问题，所有人都没法干活了。

虽然说分布式版本控制系统中不需要所谓的中央服务器这个东西，但在实际使用的时候，可能会由于一些原因，两台电脑之间互相访问不了，所以很少在两人之间的电脑上推送版本库的修改。因此，分布式版本控制系统通常也有一台充当“中央服务器”的电脑，但这个服务器的作用仅仅是用来方便“交换”大家的修改，没有它大家也一样干活，只是交换修改不方便而已。

### 创建版本库

在项目目录里通过 `git init` 命令，把这个目录变成 Git 可以管理的仓库。

当前目录下会多一个 `.git` 目录，这个目录就是 Git 用来跟踪管理版本库的。

**把文件添加到版本库**：

所有的版本控制系统都只能跟踪文本文件的改动，比如 `.txt` 文件、网页、所有程序代码等。版本控制系统可以记录每一次的改动，都改动了什么。但是图片、视频这些二进制的文件，没法记录都改了啥。

Microsoft 的 Word 格式是二进制格式，没有办法用版本控制系统跟踪。

把一个文件放到 Git 仓库

1. 用命令 `git add <filename>` 告诉 Git 把文件添加到仓库
2. 用`git commit - m 'commit message'` 告诉 Git 把文件提交到仓库

### 版本控制

`git status`命令可以让我们时刻掌握仓库当前的状态

`git diff <filename>` 查看具体修改了什么内容

#### 版本回退

`git log` 命令显示从最近到最远的提交日志，记录了谁谁谁在啥时间都提交了啥，还有`commit id`。

如果嫌输出信息太多，看得眼花缭乱的，可以试试加上`--pretty=oneline`参数

每提交一个新版本，实际上 Git 就会把它们自动串成一条时间线。

要想版本回退，首先，Git必须知道当前版本是哪个版本，在Git中，用`HEAD`表示当前版本，也就是最新的提交。上一个版本就是`HEAD^`，上上一个版本就是`HEAD^^`，当然往上100个版本可以写成`HEAD~100`。

回退到上一个版本的命令就是 `git reset --hard HEAD^`

回退后再用 `git log` 命令看看版本库的状态，会发现最新的版本变成了回退到的版本。这个时候如果还知道回退之前那个版本的 `commit id`，可以用命令 `git reset --hard commit-id`，撤销之前的回退。

在Git中，总是有后悔药可以吃的。当你用`$ git reset --hard HEAD^`回退到`add distributed`版本时，再想恢复到`append GPL`，就必须找到`append GPL`的commit id。Git提供了一个命令`git reflog`用来记录你的每一次命令：

![image-20210316160636102](https://gitee.com/pengpoo/pictures/raw/master/notes_imgs/2021/03/16/20210316160643.png)

#### 工作区和暂存区

**工作区**就是在电脑里能看到的目录

工作区里有一个隐藏目录`.git`，这就是 Git 的版本库。

Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支`master`，以及指向`master`的一个指针叫`HEAD`。

![image-20210316161533317](https://gitee.com/pengpoo/pictures/raw/master/notes_imgs/2021/03/16/20210316161533.png)

把文件往Git版本库里添加的时候，第一步 `git add` 就是把文件修改添加到暂存区；第二步 `git commit` 就是把暂存区的所有内容提交到当前分支。

从来没有使用 `git add` 命令添加过的文件，`git status` 命令输出的信息会显示 `Untracked`。